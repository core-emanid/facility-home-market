---
import 'swiper/css';
import Image from 'astro/components/Image.astro';
import prevIcon from '../../images/anterior.svg';
import nextIcon from '../../images/proxima.svg';

// Benefits data
const benefits = [
    {
        title: "Benefícios para o Franqueado",
        subtitle: "Um modelo de negócio simplificado e lucrativo.",
        icon: "M3 13h2V7H3v6zm4 0h2V7H7v6zm4 0h2V7h-2v6zm4 0h2V7h-2v6zm4 0h2V7h-2v6z",
        items: [
            "Baixo investimento",
            "Opção sem funcionários",
            "Software gestão online",
            "Segurança por câmeras",
            "Gestão simplificada"
        ]
    },
    {
        title: "Benefícios para o Condomínio",
        subtitle: "Comodidade e valorização do seu espaço.",
        icon: "M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z",
        items: [
            "Zero custo de implantação",
            "Valorização do imóvel",
            "Conveniência para moradores",
            "Não precisa de gestão interna",
            "Pagamos a luz por medidor"
        ]
    },
    {
        title: "Benefícios para o Consumidor",
        subtitle: "Compra rápida e acessível para o dia a dia",
        icon: "M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z",
        items: [
            "Produtos essenciais 24h",
            "Pagamento digital fácil",
            "Sem filas ou deslocamentos",
            "Ambiente seguro",
            "Economia de tempo"
        ]
    }
];

// Testimonials data
const testimonials = [
    {
        id: 1,
        name: "Ana Maria",
        location: "Jacareí / SP",
        image: "Icone_Condominio.png",
        text: "Foi acolhida pela família Facility como eles mesmos chamam, com total dedicação. Estou indo para minha quarta operação."
    },
    {
        id: 2,
        name: "Carlos Silva",
        location: "São Paulo / SP",
        image: "Icone_Condominio.png",
        text: "A Facility transformou completamente minha experiência como franqueado. O suporte é incrível e os resultados superaram todas as expectativas."
    },
    {
        id: 3,
        name: "Maria Santos",
        location: "Campinas / SP",
        image: "Icone_Condominio.png",
        text: "Como moradora, a Facility facilitou muito minha vida. Produtos de qualidade 24h por dia, sem precisar sair do condomínio."
    }
];

function getPrevSlideId(id: number): string {
    const prevId = id - 1 !== 0 ? id - 1 : testimonials[testimonials.length - 1]['id'];
    return `#testimonial-slide-${prevId}`;
}

function getNextSlideId(id: number): string {
    const nextId = id + 1 < testimonials.length + 1 ? id + 1 : testimonials[0]['id'];
    return `#testimonial-slide-${nextId}`;
}

const images = import.meta.glob('/src/images/franquia/*.png');
---

<section class="py-12 sm:py-16 lg:py-20 px-6 sm:px-8 lg:px-12 bg-white relative overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 opacity-5">
        <div 
            class="absolute inset-0" 
            style="background-image: url('data:image/svg+xml,%3Csvg width=%2260%22 height=%2260%22 viewBox=%220 0 60 60%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cg fill=%22none%22 fill-rule=%22evenodd%22%3E%3Cg fill=%22%2300a651%22 fill-opacity=%220.1%22%3E%3Cpath d=%22M10 10h10v10H10zM25 10h10v10H25zM40 10h10v10H40zM10 25h10v10H10zM25 25h10v10H25zM40 25h10v10H40zM10 40h10v10H10zM25 40h10v10H25zM40 40h10v10H40z%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"
        ></div>
    </div>

    <div class="max-w-7xl mx-auto relative z-10">
        <!-- Benefits Section -->
        <div class="mb-16 sm:mb-20 lg:mb-24">
            <!-- Section Title -->
            <div class="text-center mb-12 sm:mb-16 lg:mb-20">
                <h2 class="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold text-gray-900 mb-4">
                    Na Facility todo mundo sai ganhando!
                </h2>
            </div>

            <!-- Benefits Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 lg:gap-12">
                {benefits.map((benefit) => (
                    <div class="bg-white rounded-lg p-6 sm:p-8 lg:p-10 shadow-lg hover:shadow-xl transition-shadow duration-300">
                        <!-- Icon -->
                        <div class="w-16 h-16 sm:w-20 sm:h-20 lg:w-24 lg:h-24 bg-blue-100 rounded-full flex items-center justify-center mb-6">
                            <svg class="w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d={benefit.icon} />
                            </svg>
                        </div>

                        <!-- Title -->
                        <h3 class="text-xl sm:text-2xl lg:text-3xl font-bold text-green-600 mb-3">
                            {benefit.title}
                        </h3>

                        <!-- Subtitle -->
                        <p class="text-gray-600 text-sm sm:text-base lg:text-lg mb-6">
                            {benefit.subtitle}
                        </p>

                        <!-- Divider -->
                        <div class="border-t border-blue-200 mb-6"></div>

                        <!-- Benefits List -->
                        <ul class="space-y-2 sm:space-y-3">
                            {benefit.items.map((item) => (
                                <li class="text-gray-700 text-sm sm:text-base lg:text-lg">
                                    // {item}
                                </li>
                            ))}
                        </ul>
                    </div>
                ))}
            </div>
        </div>

        <!-- Testimonials Section -->
        <div>
            <!-- Section Title -->
            <div class="text-center mb-12 sm:mb-16 lg:mb-20">
                <h2 class="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold text-gray-900 mb-4">
                    Verdadeiros depoimentos, casos de sucesso!
                </h2>
            </div>

            <!-- Desktop Testimonials Carousel -->
            <div class="w-full flex justify-center shadow-xl rounded-2xl p-4 max-md:hidden">
                <div id='testimonial-carousel' class="carousel w-full max-w-[750px] min-h-[300px]">
                    {
                        testimonials.map((testimonial) => (
                            <div id={`testimonial-slide-${testimonial.id}`} class="carousel-item relative w-full">
                                <div class="flex flex-col items-center max-sm:px-2">
                                    <div class="w-[60%] lg:w-full card-body text-justify text-xl pb-2">
                                        <p class="p-4">"{testimonial.text}"</p>
                                    </div>
                                    
                                    <div class="flex flex-row items-center w-full">
                                        <div class="flex flex-row w-full justify-center lg:justify-start p-4">
                                            <Image 
                                                src={images[`/src/images/franquia/${testimonial.image}`]?.() || images['/src/images/depoimentos-sem-foto.png']?.()} 
                                                alt={`Foto de ${testimonial.name}`} 
                                                class="rounded-full relative z-1" 
                                                width={100} 
                                            />
                                            <span class="flex flex-col pl-4 justify-center self-center text-xl">
                                                <h3 class="font-extrabold">{testimonial.name}</h3>
                                                <p class="font-semibold">{testimonial.location}</p>
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="absolute flex justify-between transform -translate-y-1/2 left-5 right-5 bottom-0">
                                    <div class="flex justify-end align-end gap-2 w-full bottom-0">
                                        <a href={getPrevSlideId(testimonial.id)} class="btn btn-circle rounded-full bg-green-600 text-white font-extrabold text-xl px-3 py-1">
                                            <Image src={prevIcon} alt="seta de navegação - slide anterior"/>
                                        </a> 
                                        <a href={getNextSlideId(testimonial.id)} class="btn btn-circle rounded-full bg-green-600 text-white font-extrabold text-xl px-3 py-1">
                                            <Image src={nextIcon} alt="seta de navegação - slide posterior"/>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        ))
                    }
                </div>
            </div>

            <!-- Mobile Testimonials Carousel -->
            <div class="w-full flex justify-center shadow-sm rounded-2xl p-4 lg:hidden">
                <div class="swiper-testimonial w-full max-w-[750px] min-h-[300px]">
                    <div class="swiper-wrapper" role="group">
                        {
                            testimonials.map((testimonial) => (
                                <div class="h-full w-full swiper-slide">
                                    <div class="flex flex-col items-center justify-between px-6 h-full">
                                        <div class="w-[60%] lg:w-full text-justify text-xl pb-2">
                                            <p class="py-2 px-10">"{testimonial.text}"</p>
                                        </div>
                                        
                                        <div class="flex flex-row items-center w-full">
                                            <div class="flex flex-row w-full justify-center lg:justify-start p-4">
                                                <Image 
                                                    src={images[`/src/images/franquia/${testimonial.image}`]?.() || images['/src/images/depoimentos-sem-foto.png']?.()} 
                                                    alt={`Foto de ${testimonial.name}`} 
                                                    class="rounded-full relative z-1" 
                                                    width={100} 
                                                />
                                                <span class="flex flex-col pl-4 justify-center self-center text-xl">
                                                    <h3 class="font-extrabold">{testimonial.name}</h3>
                                                    <p class="font-semibold">{testimonial.location}</p>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    import Swiper from 'swiper';
    import { Autoplay } from 'swiper/modules';

    Swiper.use([Autoplay])
    let swiperTestimonial = new Swiper('.swiper-testimonial', {
        speed: 1400,
        loop: true,
        slidesPerView: 1,
        autoplay: {
            delay: 6000,
        },
        freeMode: {
            enabled: false
        },
        shortSwipes: true,
        centeredSlides: true,
        centeredSlidesBounds: true
    });
</script>
